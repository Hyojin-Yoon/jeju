var positions = [{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            복자씨연탄구이/고기 ★4.4(976)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.kakaocdn.net%2Fmystore%2FBCBBE0CE30184D5080B76BBBF432FA65); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 12:00 ~ 22:00</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">흑돼지 근고기 600g 63,000원</div>' +
    '                <div><a href="https://place.map.kakao.com/18678487" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.46932190297041, 126.91989162113339)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            해왓/해물 ★4.2(153)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.daumcdn.net%2Flocal%2FkakaomapPhoto%2Freview%2F1b96e4c9031a5246dafe8984860c2ce6fb15da8a%3Foriginal); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 09:00 ~ 21:30 / 수 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">고등어회 55,000</div>' +
    '                <div><a href="https://place.map.kakao.com/382375401" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.438532351795985, 126.91715613532612)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            부촌/해물 ★4.3(267)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.daumcdn.net%2Flocal%2FkakaomapPhoto%2Freview%2Fc23a6c6ff799d1fecd2844bb3409b03034c677c0%3Foriginal); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 10:30 ~ 21:00 / 목 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 15:30 ~ 17:00</div>' +
    '                <div class="jibun ellipsis">보말국 정식 12,000</div>' +
    '                <div><a href="https://place.map.kakao.com/10471937" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.44887815674848, 126.9168639734868)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            일출봉도식후경/한식 ★4.8(193)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.daumcdn.net%2Flocal%2FkakaomapPhoto%2Freview%2Fcb20407caaba0aff6a7a214b4be03038e1e20227%3Foriginal); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 10:00 ~ 20:00 / 화 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 15:00 ~ 17:00</div>' +
    '                <div class="jibun ellipsis">정식 2인 이상 15,000원 흑돼지제육 + 해물된장찌개</div>' +
    '                <div><a href="https://place.map.kakao.com/994541543" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.43843017356933, 126.9194441543978)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            그리운바다 성산포/한식 ★4.0(132)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.daumcdn.net%2Flocal%2FkakaomapPhoto%2Freview%2Fb0a52c5c9c90545167246ad5cd8e6164980a9246%3Foriginal); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 09:00 ~ 21:00 / 화 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">그리운 코스 2인 80,000원 고등어회 + 은갈치회 + 회국수 + 고등어구이 + 전복성게미역국</div>' +
    '                <div><a href="https://place.map.kakao.com/18277817" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.469857738431614, 126.93003584717297)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            한라전복 성산본점/전복 ★4.4(110)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.daumcdn.net%2Flocal%2FkakaomapPhoto%2Freview%2F55459344670245a419e34e7c69461d2f5d5732b8%3Foriginal); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 10:00 ~ 20:00 / 수 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 15:30 ~ 17:30</div>' +
    '                <div class="jibun ellipsis">전복돌솥밥 / 전복뚝배기 15,000</div>' +
    '                <div><a href="https://place.map.kakao.com/10112205" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.47094966963275, 126.91701772286036)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            제주일도 성산점/고기 ★4.8(106)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=https%3A%2F%2Fpostfiles.pstatic.net%2FMjAyNDAxMzFfOTQg%2FMDAxNzA2NjY2MDkyNTIx.uLclQYN8jtaj65L7Hry6zakdAdI0P0prHHyfyUGeXO8g.EJPeT0ByHqifGP-hHR7oN80d-R3wt3G1zsgQoxTUhoQg.JPEG.saessak_22%2FSE-ff37e23f-21ce-4f18-a5e4-e3c2f6d7b7c0.jpg%3Ftype%3Dw466); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 12:00 ~ 22:00</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis"흑오겹 + 흑목살 900g 96,000원</div>' +
    '                <div><a href="https://place.map.kakao.com/1454037117" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.436794924031474, 126.921279194869)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            성산일출봉해송/해물 ★4.7(213)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.kakaocdn.net%2Fmystore%2FE8585A4028F2456EB8BFEFA776D96716); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 09:00 ~ 21:00 / 목 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">스페샬조림세트(4인) 195,000원 통갈치조림+통갈치구이</div>' +
    '                <div><a href="https://place.map.kakao.com/2143392674" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.46170268836647, 126.93415960750492)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            청호식당/한식 ★4.8(129)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=http%3A%2F%2Ft1.kakaocdn.net%2Fmystore%2FACFDECF3AF1C4216A7B248A78D9D7B4F); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 09:00 ~ 20:00 / 수 휴무</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">문어라면 2인 40,000원 문어볶음 2인 30,000원</div>' +
    '                <div><a href="https://place.map.kakao.com/27268966" target="_blank" class="link">상세보기</a></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.410512604731494, 126.90784316326084)
},{
  title: '<div class="wrap">' +
    '    <div class="info">' +
    '        <div class="title">' +
    '            제주 오션스토리/회 ★4.1(13)' +
    '            <div class="close" onclick="closeOverlay()"></div>' +
    '        </div>' +
    '        <div class="body">' +
    '            <div class="img" style="background-image: url(https://img1.kakaocdn.net/cthumb/local/R0x420.q50/?fname=https%3A%2F%2Fpostfiles.pstatic.net%2FMjAyMzEyMjVfMTU4%2FMDAxNzAzNDgwMzYyODAz.ik2zfjYh40hA_Nv7F-pUQ1nGfNJ6mXl-a6mk9TgyqWQg.bPrpg9R5gqJXgZ4DJWDul9jvOQk7ci25C18xl8h-DNAg.JPEG.psj_0502%2Foutput_2081549306.jpg%3Ftype%3Dw966); background-position: center; background-size: cover;">' +
    // '                <img src="">' +
    '           </div>' +
    '            <div class="desc">' +
    '                <div class="ellipsis">영업시간: 16:00 ~ 21:00</div>' +
    '                <div class="jibun ellipsis">브레이크 x</div>' +
    '                <div class="jibun ellipsis">참돔 + 고등어 / 광어 + 고등어 45,000원</div>' +
    '                <div><a href="https://place.map.kakao.com/126137610" target="_blank" class="link">상세보기</a><span><button class="saveBtn">저장</button></span></div>' +
    '            </div>' +
    '        </div>' +
    '    </div>' +
    '</div>',
  latlng: new kakao.maps.LatLng(33.411501860676196, 126.89881957819385)
}
];

for (let i = 0; i < positions.length; i++) {
  var data = positions[i];
  displayMarker(data);
}

// 지도에 마커 + 커스텀오버레이를 표시하는 함수입니다    
function displayMarker(data) {
  var marker = new kakao.maps.Marker({
    map: map,
    position: data.latlng,
    image: foodMarkerImage
  });

  var overlay = new kakao.maps.CustomOverlay({
    yAnchor: 2,
    position: marker.getPosition()
  });

  var content = document.createElement('div');
  content.innerHTML = data.title;

  overlay.setContent(content);

  // 마커 클릭 시 오버레이 열고 닫기
  var isOverlayOpen = false;

  kakao.maps.event.addListener(marker, 'click', function () {
    if (isOverlayOpen) {
      overlay.setMap(null);
      isOverlayOpen = false;
    } else {
      overlay.setMap(map);
      isOverlayOpen = true;
    }
  });

  // 'div.close' 요소를 클릭하면 커스텀 오버레이를 제거합니다
  var closeButton = content.querySelector('.close');
  closeButton.onclick = function () {
    overlay.setMap(null);
    isOverlayOpen = false;
  };

  // 지도 이동 종료 이벤트 핸들러
  map.addListener('dragend', function () {
    // 오버레이 맵에서 제거
    overlay.setMap(null);
    isOverlayOpen = false;
  });

  // 줌인/줌아웃 시 오버레이를 닫기
  map.addListener('zoom_changed', function () {
    // 오버레이 맵에서 제거
    overlay.setMap(null);
    isOverlayOpen = false;
  });
}